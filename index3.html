<html>
  <head>
    <title>Testing Image Fije</title>
    <style>
      * {
        margin: 0;
      }
      video {
        width: 100vw;
        height: 100vh;
        object-fit: cover;
        z-index: -1;
        position: absolute;
      }
      h1 {
        color: #fff;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <video id="video-main"></video>
    <script>
    var video = document.getElementById("video-main");
    cvs = document.createElement("canvas");
    ctx = cvs.getContext("2d");

    navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } }).then(function(stream) {
    track = stream.getTracks()[0];
    video.srcObject = stream;
    video.setAttribute("playsinline", true); // required to tell iOS safari we don't want fullscreen
    video.play();
    requestAnimationFrame(tick);
  });


  function tick() {
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
      cvs.hidden = false;

      cvs.height = video.videoHeight;
      cvs.width = video.videoWidth;
      ctx.drawImage(video, 0, 0, cvs.width, cvs.height);
      var imageData = ctx.getImageData(0, 0, cvs.width, cvs.height);
    requestAnimationFrame(tick);
  } 
    //   $(function () {
    //     var video = $("body > video")[0],
    //       cvs = document.createElement("canvas"),
    //       ctx = cvs.getContext("2d");

    //     navigator.getMedia =
    //       navigator.getUserMedia ||
    //       navigator.webkitGetUserMedia ||
    //       navigator.mozGetUserMedia ||
    //       navigator.msGetUserMedia;

    //     navigator.getMedia(
    //       { video: !0, audio: !1 },
    //       function (stream) {
    //         if (navigator.mozGetUserMedia) video.mozSrcObject = stream;
    //         else {
    //           var vu = window.URL || window.webkitURL;
    //           video.src = vu.createObjectURL(stream);
    //         }
    //         video.play();
    //       },
    //       function (error) {
    //         if (window.console) console.error(error);
    //       }
    //     );

    //     video.addEventListener(
    //       "canplay",
    //       function (ev) {
    //         if (!streaming) {
    //           height = video.videoHeight / (video.videoWidth / width);
    //           video.setAttribute("width", width);
    //           video.setAttribute("height", height);
    //           streaming = !0;
    //         }
    //       },
    //       !1
    //     );
    //   });
    </script>
  </body>
</html>


<!-- navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } }).then(function(stream) {
    track = stream.getTracks()[0];
    video.srcObject = stream;
    video.setAttribute("playsinline", true); // required to tell iOS safari we don't want fullscreen
    video.play();
    requestAnimationFrame(tick);
  });

  function tick() {
    loadingMessage.innerText = "âŒ› Loading video..."
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
      loadingMessage.hidden = true;
      cvs.hidden = false;
      outputContainer.hidden = false;

      cvs.height = video.videoHeight;
      cvs.width = video.videoWidth;
      canvas.drawImage(video, 0, 0, cvs.width, cvs.height);
      var imageData = canvas.getImageData(0, 0, cvs.width, cvs.height);
      var code = jsQR(imageData.data, imageData.width, imageData.height, {
        inversionAttempts: "dontInvert",
      });
      if (code) {
        drawLine(code.location.topLeftCorner, code.location.topRightCorner, "#FF3B58");
        drawLine(code.location.topRightCorner, code.location.bottomRightCorner, "#FF3B58");
        drawLine(code.location.bottomRightCorner, code.location.bottomLeftCorner, "#FF3B58");
        drawLine(code.location.bottomLeftCorner, code.location.topLeftCorner, "#FF3B58");
        outputMessage.hidden = true;
        outputData.parentElement.hidden = false;
        outputData.innerText = code.data;
    qrFound(code.data);
      } else {
        outputMessage.hidden = false;
        outputData.parentElement.hidden = true;
      }
    }
    requestAnimationFrame(tick);
  } -->